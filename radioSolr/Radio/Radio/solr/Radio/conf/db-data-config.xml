<dataConfig>

  <dataSource type="JdbcDataSource" 
              driver="com.mysql.jdbc.Driver"
              convertType="true"
              url="jdbc:mysql://localhost/Radio" 
              user="root" 
              password=""/>
    <document>
        <entity name="song" rootEntity="true" transformer="TemplateTransformer"
           query="SELECT id, title, artist_name FROM RS_Song">
            <field column="type" template="song"/>       
            <field column="id" name="typeId"/>
            <field column="uniqueId" template="${song.type}:${song.id}"/>

            <field column="title" name="primaryIdentifier"/>
            <field column="artist_name" name="secondaryIdentifier"/>
            <field column="identifierText" template="${song.title} ${song.artist_name}"/>
            <entity name="radio" query="SELECT count(*) AS spins FROM rs_spin WHERE song_id='${song.id}'">
              <field column="spins" name="spins"/>
            </entity>
        </entity>
        
        <entity name="artist" rootEntity="true" transformer="TemplateTransformer"
           query="SELECT id, name FROM RS_Artist">
          <field column="type" template="artist"/>    
          <field column="id" name="typeId"/>
          <field column="uniqueId" template="${artist.type}:${artist.id}"/>
            
          <field column="name" name="primaryIdentifier"/>
          <field column="identifierText" template="${artist.name}"/>
          
          <entity name="radio" query="SELECT count(*) AS spins FROM rs_spin WHERE artist_id='${artist.id}'">
            <field column="spins" name="spins"/>
          </entity>
          
          <entity name="membersen" query="SELECT a.name as member FROM RS_Bandmember as bm JOIN RS_Artist as a on bm.member = a.id where bm.band='${artist.id}'">
            <field column="member" name="members"/>
          </entity>
          
          <entity name="bandsen" query="SELECT a.name as band FROM RS_Bandmember as bm JOIN RS_Artist as a on bm.band = a.id where bm.member='${artist.id}'">
            <field column="band" name="bands"/>
          </entity>
          
          <field column="secondaryIdentifier" template="${artist.members} ${artist.bands}"/>
          <field column="identifierText" template="${artist.name} ${artist.members} ${artist.bands}"/>
          
        </entity>
    </document>
</dataConfig>

